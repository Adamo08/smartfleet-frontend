<div class="p-6 backdrop-blur-2xl bg-gradient-to-br from-slate-900/40 via-indigo-900/30 to-slate-900/40 border border-white/10 rounded-3xl">
  <div class="flex justify-between items-center mb-4">
    <h2 class="text-xl font-semibold text-white">Slots</h2>
    <button (click)="openCreateSlotForm()" class="px-4 py-2 rounded-xl bg-gradient-to-r from-green-600 to-emerald-600 text-white font-semibold hover:from-green-700 hover:to-emerald-700 transition-colors duration-200">
      Create New Slot
    </button>
  </div>

  <!-- Filter Section -->
  <div class="mb-6 p-4 rounded-xl border border-white/10 bg-slate-800/50">
    <h3 class="text-lg font-semibold text-white mb-3">Filter Slots</h3>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
      <!-- Vehicle Filter -->
      <div>
        <label for="filterVehicle" class="block text-gray-300 text-sm font-bold mb-2">Vehicle:</label>
        <select
          id="filterVehicle"
          name="filterVehicle"
          [(ngModel)]="selectedFilterVehicleId"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline bg-gray-700 border-gray-600 text-white"
        >
          <option [value]="null">All Vehicles</option>
          @for (vehicle of vehicles; track vehicle.id) {
            <option [value]="vehicle.id">{{ vehicle.brandName }} - {{ vehicle.modelName }} ({{ vehicle.licensePlate }})</option>
          }
        </select>
      </div>

      <!-- Start Date Filter -->
      <div>
        <label for="filterStartDate" class="block text-gray-300 text-sm font-bold mb-2">Start Date:</label>
        <input
          type="date"
          id="filterStartDate"
          name="filterStartDate"
          [(ngModel)]="filterStartDate"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline bg-gray-700 border-gray-600 text-white"
        />
      </div>

      <!-- End Date Filter -->
      <div>
        <label for="filterEndDate" class="block text-gray-300 text-sm font-bold mb-2">End Date:</label>
        <input
          type="date"
          id="filterEndDate"
          name="filterEndDate"
          [(ngModel)]="filterEndDate"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline bg-gray-700 border-gray-600 text-white"
        />
      </div>

      <!-- Availability Filter -->
      <div>
        <label for="filterIsAvailable" class="block text-gray-300 text-sm font-bold mb-2">Availability:</label>
        <select
          id="filterIsAvailable"
          name="filterIsAvailable"
          [(ngModel)]="filterIsAvailable"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline bg-gray-700 border-gray-600 text-white"
        >
          <option [value]="null">All</option>
          <option [value]="true">Available</option>
          <option [value]="false">Unavailable</option>
        </select>
      </div>
    </div>
    <div class="flex justify-end space-x-2 mt-4">
      <button (click)="clearFilters()" class="px-4 py-2 rounded-xl border border-white/10 text-gray-300 hover:bg-white/5 transition-colors duration-200">
        Clear Filters
      </button>
      <button (click)="applyFilters()" class="px-4 py-2 rounded-xl bg-gradient-to-r from-indigo-600 to-cyan-600 text-white font-semibold hover:from-indigo-700 hover:to-cyan-700 transition-colors duration-200">
        Apply Filters
      </button>
    </div>
  </div>

  @if (isLoading) {
    <div class="text-gray-300">Loading...</div>
  } @else if (!isLoading && slots.length === 0) {
    <div class="text-center text-gray-400 py-8">
      <p class="text-lg">No slots found.</p>
      <p class="text-sm">Try adjusting your filters or adding new slots.</p>
    </div>
  } @else {
  <table class="min-w-full text-sm text-gray-200">
    <thead>
      <tr class="text-left border-b border-indigo-500/10">
        <th class="p-2">ID</th>
        <th class="p-2">Vehicle</th>
        <th class="p-2">Start</th>
        <th class="p-2">End</th>
        <th class="p-2">Available</th>
      </tr>
    </thead>
    <tbody>
      @for (s of slots; track s.id) {
        <tr class="border-b border-indigo-500/10">
          <td class="p-2">{{ s.id }}</td>
          <td class="p-2">{{ s.vehicleBrand }} - {{ s.vehicleModel }}</td>
          <td class="p-2">{{ s.startTime | date:'medium' }}</td>
          <td class="p-2">{{ s.endTime | date:'medium' }}</td>
          <td class="p-2">{{ s.available ? 'Yes' : 'No' }}</td>
        </tr>
      }
    </tbody>
  </table>
  }
  <div class="mt-4">
    <app-pagination
      [currentPage]="page"
      [totalPages]="(totalElements / size) | ceil"
      (pageChange)="load($event)"
    >
    </app-pagination>
  </div>

  <!-- Create Slot Modal/Form -->
  @if (isCreateSlotFormOpen) {
    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-slate-800 p-8 rounded-lg shadow-lg max-w-md w-full border border-white/10">
        <h3 class="text-xl font-semibold text-white mb-4">Create New Slot</h3>
        <form (ngSubmit)="submitCreateSlot()">
          <div class="mb-4">
            <label for="vehicleId" class="block text-gray-300 text-sm font-bold mb-2">Vehicle:</label>
            <select
              id="vehicleId"
              name="vehicleId"
              [(ngModel)]="newSlot.vehicleId"
              required
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline bg-gray-700 border-gray-600 text-white"
            >
              <option [value]="0" disabled>Select a vehicle</option>
              @for (vehicle of vehicles; track vehicle.id) {
                <option [value]="vehicle.id">{{ vehicle.brandName }} - {{ vehicle.modelName }} ({{ vehicle.licensePlate }})</option>
              }
            </select>
          </div>
          <div class="mb-4">
            <label for="startTime" class="block text-gray-300 text-sm font-bold mb-2">Start Time:</label>
            <input
              type="datetime-local"
              id="startTime"
              name="startTime"
              [(ngModel)]="newSlot.startTime"
              required
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline bg-gray-700 border-gray-600 text-white"
            />
          </div>
          <div class="mb-6">
            <label for="endTime" class="block text-gray-300 text-sm font-bold mb-2">End Time:</label>
            <input
              type="datetime-local"
              id="endTime"
              name="endTime"
              [(ngModel)]="newSlot.endTime"
              required
              class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline bg-gray-700 border-gray-600 text-white"
            />
          </div>
          <div class="flex items-center justify-between">
            <button
              type="submit"
              class="px-4 py-2 rounded-xl bg-gradient-to-r from-indigo-600 to-cyan-600 text-white font-semibold hover:from-indigo-700 hover:to-cyan-700 transition-colors duration-200"
            >
              Create Slot
            </button>
            <button
              type="button"
              (click)="closeCreateSlotForm()"
              class="px-4 py-2 rounded-xl border border-white/10 text-gray-300 hover:bg-white/5"
            >
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>
  }
</div>
