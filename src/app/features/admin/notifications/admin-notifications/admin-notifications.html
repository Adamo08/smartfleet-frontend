<div class="bg-white border border-gray-200 rounded-lg p-6 shadow-sm">
  <h2 class="text-xl font-semibold text-gray-900 mb-4">Admin Notifications</h2>

  <form [formGroup]="filterForm" (ngSubmit)="onFilterChange()" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4">
    <input type="number" class="bg-white border border-gray-300 rounded-lg p-3 text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="User ID" formControlName="userId" (change)="onFilterChange()">
    <select class="bg-white border border-gray-300 rounded-lg p-3 text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 [&>option]:bg-white [&>option]:text-gray-700 [&>option]:p-2" formControlName="read" (change)="onFilterChange()">
      <option [value]="null">All Statuses</option>
      <option [value]="true">Read</option>
      <option [value]="false">Unread</option>
    </select>
    <select class="bg-white border border-gray-300 rounded-lg p-3 text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 [&>option]:bg-white [&>option]:text-gray-700 [&>option]:p-2" formControlName="type" (change)="onFilterChange()">
      <option value="">All Types</option>
      @for (type of NotificationType | keyvalue; track type.key) {
        <option [value]="type.value">{{ type.value }}</option>
      }
    </select>
    <input type="date" class="bg-white border border-gray-300 rounded-lg p-3 text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Start Date" formControlName="startDate" (change)="onFilterChange()">
    <input type="date" class="bg-white border border-gray-300 rounded-lg p-3 text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="End Date" formControlName="endDate" (change)="onFilterChange()">
    <button type="button" class="px-4 py-2 rounded-lg bg-gray-600 text-gray-900 hover:bg-gray-700 transition-colors duration-200" (click)="clearFilters()">Clear Filters</button>
    <button type="submit" class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700">Apply Filters</button>
  </form>

  @if (isLoading) {
    <!-- Advanced Skeleton Loading -->
    <app-skeleton-page
      pageType="table"
      [showFilters]="true"
      [showPagination]="true"
      [filterCount]="3"
      [tableHeaders]="['ID', 'User', 'Type', 'Title', 'Message', 'Read', 'Created', 'Actions']"
      [tableRows]="5">
    </app-skeleton-page>
  } @else if (notificationsPage && notificationsPage.content.length > 0) {
    <div class="overflow-x-auto rounded-lg shadow-xl">
      <table class="min-w-full text-sm text-gray-900 bg-white">
        <thead class="bg-gray-50/50">
          <tr>
            <th class="px-6 py-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">ID</th>
            <th class="px-6 py-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">User</th>
            <th class="px-6 py-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Type</th>
            <th class="px-6 py-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Title</th>
            <th class="px-6 py-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Message</th>
            <th class="px-6 py-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Read</th>
            <th class="px-6 py-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Created</th>
            <th class="px-6 py-4 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">Actions</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-white/10">
          @for (notification of notificationsPage.content; track notification.id) {
            <tr class="hover:bg-gray-50/30 transition-colors duration-200">
              <td class="px-6 py-4 whitespace-nowrap">
                <span class="text-gray-900 font-medium">#{{ notification.id }}</span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="flex items-center">
                  <div class="ml-0">
                    <div class="text-sm font-medium text-gray-900">User #{{ notification.userId }}</div>
                    <div class="text-sm text-gray-400">ID: {{ notification.userId }}</div>
                  </div>
                </div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span [class]="getTypeColor(notification.type)" class="px-3 py-1 rounded-full text-xs font-medium">
                  {{ notification.type }}
                </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span class="text-gray-900">{{ notification.type }}</span>
              </td>
              <td class="px-6 py-4">
                <span class="text-gray-600">{{ notification.message | slice:0:50 }}{{ notification.message.length > 50 ? '...' : '' }}</span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span [class]="notification.read ? 'bg-green-500/20 text-green-400' : 'bg-yellow-500/20 text-yellow-400'" 
                      class="px-3 py-1 rounded-full text-xs font-medium">
                  {{ notification.read ? 'Read' : 'Unread' }}
                </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span class="text-gray-600">{{ notification.createdAt | date:'short' }}</span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <app-action-icons
                  [actions]="{ view: true, delete: true }"
                  (onView)="viewNotification(notification)"
                  (onDelete)="openDeleteNotificationModal(notification)">
                </app-action-icons>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
    <div class="mt-6 flex justify-center">
      <app-pagination
        [currentPage]="notificationsPage.number"
        [totalPages]="notificationsPage.totalPages"
        (pageChange)="onPageChange($event)">
      </app-pagination>
    </div>
  } @else {
    <div class="text-gray-600 text-center py-8 border border-gray-200 rounded-lg bg-gray-50">
      No notifications found.
    </div>
  }

  @if (showNotificationDetailModal && selectedNotification) {
    <app-modal [title]="'Notification Details'" (close)="closeNotificationDetailModal()">
      <app-notification-detail [notification]="selectedNotification"></app-notification-detail>
    </app-modal>
  }

  @if (showDeleteNotificationModal && notificationToDelete) {
    <app-configrm-dialog
      [title]="'Confirm Deletion'"
      [message]="'Are you sure you want to delete notification #' + notificationToDelete.id + '? This action cannot be undone.'"
      [confirmButtonText]="'Delete'"
      [cancelButtonText]="'Cancel'"
      [actionType]="DialogActionType.DELETE"
      (confirmed)="confirmDeleteNotification()"
      (cancelled)="closeDeleteNotificationModal()">
    </app-configrm-dialog>
  }
</div>
