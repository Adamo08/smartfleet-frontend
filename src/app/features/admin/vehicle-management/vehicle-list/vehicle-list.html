<div class="p-6 backdrop-blur-2xl bg-gradient-to-br from-slate-900/40 via-indigo-900/30 to-slate-900/40 border border-white/10 rounded-3xl">
  <div class="flex items-center justify-between mb-6">
    <h2 class="text-xl font-semibold text-white">Vehicles</h2>
    <button (click)="openAddVehicleModal()" class="px-4 py-2 rounded-xl bg-gradient-to-r from-indigo-600 to-cyan-600 text-white">New Vehicle</button>
  </div>

  <div class="flex justify-between items-center mb-4">
    <input type="text" placeholder="Search vehicles..." class="p-2 rounded-xl bg-slate-800 text-white border border-white/10">
    <button class="px-4 py-2 rounded-xl bg-gradient-to-r from-green-600 to-emerald-600 text-white">Export CSV</button>
  </div>

  @if (isLoading) {
    <div class="text-gray-300">Loading...</div>
  } @else if (vehiclesPage && vehiclesPage.content.length > 0) {
    <div class="overflow-x-auto rounded-lg shadow-xl">
      <table class="min-w-full text-sm text-gray-200 bg-slate-800">
        <thead>
          <tr class="text-left border-b border-indigo-500/20 bg-slate-700">
            <th class="p-3 text-white">ID</th>
            <th class="p-3 text-white">Brand</th>
            <th class="p-3 text-white">Model</th>
            <th class="p-3 text-white">Year</th>
            <th class="p-3 text-white">Status</th>
            <th class="p-3 text-white">Price/Day</th>
            <th class="p-3 text-white">Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (v of vehiclesPage.content; track v.id) {
            <tr class="border-b border-indigo-500/10 hover:bg-slate-700/50 transition-colors duration-200">
              <td class="p-3">{{ v.id }}</td>
              <td class="p-3">{{ v.brand }}</td>
              <td class="p-3">{{ v.model }}</td>
              <td class="p-3">{{ v.year }}</td>
              <td class="p-3"><span class="px-2 py-1 rounded-full text-xs font-semibold" [ngClass]="{
                'bg-green-500/20 text-green-300': v.status === 'AVAILABLE',
                'bg-yellow-500/20 text-yellow-300': v.status === 'RENTED',
                'bg-red-500/20 text-red-300': v.status === 'MAINTENANCE' || v.status === 'OUT_OF_SERVICE'
              }">{{ v.status }}</span></td>
              <td class="p-3">{{ v.pricePerDay | currency }}</td>
              <td class="p-3 flex space-x-2">
                <button class="text-blue-400 hover:text-blue-300 transition-colors duration-200" (click)="viewVehicle(v)">View</button>
                <button class="text-yellow-400 hover:text-yellow-300 transition-colors duration-200" (click)="openEditVehicleModal(v)">Edit</button>
                <button class="text-red-400 hover:text-red-300 transition-colors duration-200" (click)="openDeleteVehicleModal(v)">Delete</button>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
    <div class="mt-6 flex justify-center">
      <app-pagination
        [currentPage]="vehiclesPage.number"
        [totalPages]="vehiclesPage.totalPages"
        (pageChange)="onPageChange($event)">
      </app-pagination>
    </div>
  } @else {
    <div class="text-gray-300 text-center py-8 border border-white/10 rounded-xl bg-slate-900/40">
      No vehicles found.
    </div>
  }

  @if (showVehicleDetailModal && selectedVehicle) {
    <app-modal [title]="'Vehicle Details'" (close)="closeVehicleDetailModal()">
      <app-vehicle-detail [vehicle]="selectedVehicle"></app-vehicle-detail>
    </app-modal>
  }

  @if (showAddVehicleModal) {
    <app-modal [title]="'Add New Vehicle'" (close)="closeAddVehicleModal()">
      <app-vehicle-form (formSubmitted)="closeAddVehicleModal()"></app-vehicle-form>
      <div modal-actions class="flex justify-end space-x-2 mt-4">
        <button (click)="closeAddVehicleModal()" class="px-4 py-2 rounded-xl bg-gray-600 text-white hover:bg-gray-700 transition-colors duration-200">Cancel</button>
      </div>
    </app-modal>
  }

  @if (showEditVehicleModal && selectedVehicle) {
    <app-modal [title]="'Edit Vehicle'" (close)="closeEditVehicleModal()">
      <app-vehicle-form [vehicle]="selectedVehicle" (formSubmitted)="closeEditVehicleModal()"></app-vehicle-form>
      <div modal-actions class="flex justify-end space-x-2 mt-4">
        <button (click)="closeEditVehicleModal()" class="px-4 py-2 rounded-xl bg-gray-600 text-white hover:bg-gray-700 transition-colors duration-200">Cancel</button>
      </div>
    </app-modal>
  }

  @if (showDeleteVehicleModal && vehicleToDelete) {
    <app-configrm-dialog
      [title]="'Confirm Deletion'"
      [message]="'Are you sure you want to delete vehicle \'' + vehicleToDelete.brand + ' ' + vehicleToDelete.model + ' (' + vehicleToDelete.licensePlate + ' )\'? This action cannot be undone.'"
      [confirmButtonText]="'Delete'"
      [cancelButtonText]="'Cancel'"
      [actionType]="DialogActionType.DELETE"
      (confirmed)="confirmDeleteVehicle()"
      (cancelled)="closeDeleteVehicleModal()">
    </app-configrm-dialog>
  }
</div>
